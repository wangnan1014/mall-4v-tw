(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f9579df","chunk-b4777c5e","chunk-33bbf337","chunk-2d0d096d"],{"0e93":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tinymce-container",class:{fullscreen:t.fullscreen},style:{width:t.containerWidth}},[a("textarea",{staticClass:"tinymce-textarea",attrs:{id:t.tinymceId}})])},r=[];const i=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"];var o=i;const n=["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"];var l=n;let u=[];function p(){return window.tinymce}const d=(t,e)=>{const a=document.getElementById(t),s=e||function(){};if(!a){const e=document.createElement("script");e.src=t,e.id=t,document.body.appendChild(e),u.push(s);const a="onload"in e?r:i;a(e)}function r(e){e.onload=function(){this.onerror=this.onload=null;for(const t of u)t(null,e);u=null},e.onerror=function(){document.body.removeChild(e),this.onerror=this.onload=null,s(new Error("Failed to load "+t),e)}}function i(t){t.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){this.onreadystatechange=null;for(const e of u)e(null,t);u=null}}}a&&s&&(p()?s(null,a):u.push(s))};var c=d;const m="https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js",h="https://unpkg.zhimg.com/tinymce-all-in-one@4.9.3/tinymce.min.js",g="https://unpkg.com/tinymce-all-in-one@4.9.3/tinymce.min.js";var f={name:"Tinymce",props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"}},data(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1}},computed:{language(){return localStorage.getItem("lang")||"zh_CN"},containerWidth(){const t=this.width;return/^[\d]+(\.[\d]+)?$/.test(t)?t+"px":t}},watch:{value(t){!this.hasChange&&this.hasInit&&this.$nextTick(()=>window.tinymce.get(this.tinymceId).setContent(t||""))},language(){this.destroyTinymce(),this.$nextTick(()=>this.initTinymce())}},mounted(){this.init()},activated(){window.tinymce&&this.initTinymce()},deactivated(){this.destroyTinymce()},destroyed(){this.destroyTinymce()},methods:{init(){c(m,t=>{t?c(h,e=>{e?c(g,e=>{e?this.$message.error(t.message):this.initTinymce()}):this.initTinymce()}):this.initTinymce()})},initTinymce(){const t=this;window.tinymce.init({language:this.language,selector:"#"+this.tinymceId,height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:l,menubar:this.menubar,plugins:o,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:e=>{t.value&&e.setContent(t.value),t.hasInit=!0,e.on("NodeChange Change KeyUp SetContent",()=>{this.hasChange=!0,this.$emit("input",e.getContent())})},setup(e){e.on("FullscreenStateChanged",e=>{t.fullscreen=e.state})},convert_urls:!1})},destroyTinymce(){const t=window.tinymce.get(this.tinymceId);this.fullscreen&&t.execCommand("mceFullScreen"),t&&t.destroy()},setContent(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK(t){const e=this;t.forEach(t=>{window.tinymce.get(e.tinymceId).insertContent(`<img class="wscnph" src="${t}" >`)})}}},b=f,v=(a("3a96"),a("2877")),y=Object(v["a"])(b,s,r,!1,null,"c100a304",null);e["a"]=y.exports},"1e58":function(t,e,a){"use strict";a("6cdb")},"20ca":function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));const s=(t,e)=>{let a,s=e||300;return function(){let e=arguments;a&&clearTimeout(a);let r=!a;a=setTimeout(()=>{a=null},s),r&&t.apply(this,e)}}},"3a96":function(t,e,a){"use strict";a("aea0")},"432f":function(t,e,a){"use strict";a("8278")},"5e61":function(t,e,a){},"692f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-prod-prod-transport"},[a("el-form-item",{attrs:{label:"运费设置",rules:[{required:!0,message:"运费模板不能为空"}]}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.changeTransport},model:{value:t.transportId,callback:function(e){t.transportId=e},expression:"transportId"}},t._l(t.transportList,(function(t){return a("el-option",{key:t.transportId,attrs:{label:t.transName,value:t.transportId}})})),1)],1),a("el-form-item",[t.transportInfo.transfees?a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.transportInfo.transfees}},[a("el-table-column",{attrs:{label:"配送区域",width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.cityList.length?t._l(e.row.cityList,(function(e){return a("el-tag",{key:e.areaId},[t._v(t._s(e.areaName))])})):a("span",[t._v("所有地区")])]}}],null,!1,2372662209)}),a("el-table-column",{attrs:{prop:"firstPiece",label:t.tableTitle[0]}}),a("el-table-column",{attrs:{prop:"firstFee",label:t.tableTitle[1]}}),a("el-table-column",{attrs:{prop:"continuousPiece",label:t.tableTitle[2]}}),a("el-table-column",{attrs:{prop:"continuousFee",label:t.tableTitle[3]}})],1):t._e()],1),1===t.transportInfo.hasFreeCondition?a("el-form-item",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.transportInfo.transfeeFrees}},[a("el-table-column",{attrs:{label:"指定区域",width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.freeCityList,(function(e){return a("el-tag",{key:e.areaId},[t._v(t._s(e.areaName))])}))}}],null,!1,569599057)}),a("el-table-column",{attrs:{prop:"freeType",label:"包邮条件"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.freeType?a("span",[t._v("满件/重量/体积包邮")]):t._e(),1===e.row.freeType?a("span",[t._v("满金額包邮")]):t._e(),2===e.row.freeType?a("span",[t._v("满件/重量/体积且满金額包邮")]):t._e()]}}],null,!1,326830345)}),a("el-table-column",{attrs:{prop:"amount"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.freeType?a("span",[t._v("满"+t._s(e.row.amount)+"元金額包邮")]):t._e(),0===e.row.freeType?a("span",[t._v("满"+t._s(e.row.piece)+"件/重量/体积包邮")]):t._e(),2===e.row.freeType?a("span",[t._v("满"+t._s(e.row.piece)+"件/重量/体积且满"+t._s(e.row.amount)+"元金額包邮")]):t._e()]}}],null,!1,938890057)})],1)],1):t._e()],1)},r=[],i={data(){return{transportId:null,transportList:[{transportId:null,transName:""}],transportInfo:{hasFreeCondition:!1,transfeeFrees:[{freeCityList:[]}]}}},props:{value:{default:null,type:Number}},computed:{tableTitle(){var t=[["首件(个)","运费(元)","续件(个)","续费(元)"],["首重(kg)","运费(元)","续重(kg)","续费(元)"],["首体积(m³)","运费(元)","续体积(m³)","续费(元)"]];return this.transportInfo.chargeType?t[this.transportInfo.chargeType]:t[0]}},created(){this.getTransportList()},watch:{value:function(t){this.transportId=t}},methods:{getTransportList(){this.$http({url:this.$http.adornUrl("/shop/transport/list"),method:"get",params:this.$http.adornParams({})}).then(({data:t})=>{this.transportList=t})},changeTransport(t){this.$emit("input",t),t&&this.$http({url:this.$http.adornUrl("/shop/transport/info/"+t),method:"get",params:this.$http.adornParams({})}).then(({data:t})=>{this.transportInfo=t})}}},o=i,n=a("2877"),l=Object(n["a"])(o,s,r,!1,null,null,null);e["default"]=l.exports},"6cdb":function(t,e,a){},7772:function(t,e,a){"use strict";a("5e61")},8278:function(t,e,a){},8497:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-prod-sku-tag"},[a("el-form-item",{attrs:{label:"商品规格"}},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.shopTagInput()}}},[t._v("添加规格")]),t._l(t.skuTags,(function(e,s){return a("div",{key:s},[a("span",[t._v(t._s(e.tagName))]),a("el-button",{staticClass:"button-new-tag",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(e){return t.removeTag(s)}}},[t._v("删除")]),a("br"),t._l(e.tagItems,(function(e,r){return a("el-tag",{key:e.valueId,attrs:{closable:"","disable-transitions":!1},on:{close:function(e){return t.handleTagClose(s,r)}}},[t._v(" "+t._s(e.propValue)+" ")])})),t.tagItemInputs[s]&&t.tagItemInputs[s].visible?a("el-input",{ref:"saveTagInput"+s,refInFor:!0,staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(e){return t.handleInputConfirm(s)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(s)}},model:{value:t.tagItemInputs[s].value,callback:function(e){t.$set(t.tagItemInputs[s],"value",e)},expression:"tagItemInputs[tagIndex].value"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(e){return t.showTagInput(s)}}},[t._v("+ 添加")])],2)}))],2),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.isShowTagInput,expression:"isShowTagInput"}],attrs:{label:"规格名"}},[a("el-col",{attrs:{span:8}},[a("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择"},on:{change:t.handleTagClick},model:{value:t.addTagInput.propName,callback:function(e){t.$set(t.addTagInput,"propName",e)},expression:"addTagInput.propName"}},t._l(t.unUseTags,(function(t){return a("el-option",{key:t.propId,attrs:{label:t.propName,value:t.propName}})})),1)],1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.isShowTagInput,expression:"isShowTagInput"}],attrs:{label:"规格值"}},[a("el-col",{attrs:{span:8}},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择"},model:{value:t.addTagInput.selectValues,callback:function(e){t.$set(t.addTagInput,"selectValues",e)},expression:"addTagInput.selectValues"}},t._l(t.dbTagValues,(function(t){return a("el-option",{key:t.valueId,attrs:{label:t.propValue,value:t.propValue}})})),1)],1)],1),a("el-form-item",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isShowTagInput,expression:"isShowTagInput"}],attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.addTag()}}},[t._v("确定")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isShowTagInput,expression:"isShowTagInput"}],attrs:{size:"mini"},on:{click:function(e){return t.hideTagInput()}}},[t._v("取消")])],1)],1)},r=[],i={data(){return{value:[],isShowTagInput:!1,addTagInput:{propName:"",selectValues:[]},type:0,tagItemName:"",tagName:"",tagNameIndex:0,tagItemInputs:[],dbTags:[],dbTagValues:[],specs:[],maxValueId:0,maxPropId:0,initing:!1}},created:function(){this.$http({url:this.$http.adornUrl("/prod/spec/list"),method:"get",params:this.$http.adornParams()}).then(({data:t})=>{this.dbTags=t,this.maxPropId=t?Math.max.apply(Math,t.map(t=>t.propId)):0}),this.$http({url:this.$http.adornUrl("/prod/spec/listSpecMaxValueId"),method:"get",params:this.$http.adornParams()}).then(({data:t})=>{this.maxValueId=t||0})},props:{skuList:{default:[]}},computed:{unUseTags(){let t=[];for(let e=0;e<this.dbTags.length;e++){const a=this.dbTags[e];let s=this.skuTags.findIndex(t=>t.tagName===a.propName);-1===s&&t.push(a)}return t},skuTags:{get(){return this.$store.state.prod.skuTags},set(t){this.$store.commit("prod/updateSkuTags",t)}},defalutSku(){return this.$store.state.prod.defalutSku}},watch:{skuTags:{handler(t,e){if(this.initing)return void(this.initing=!1);let a=[];if(4===this.type)this.skuList.forEach(t=>{let e=t.properties.split(";");this.tagItemName!==e[this.tagNameIndex].split(":")[1]&&a.push(t)});else if(2===this.type){var s=this.tagName+":"+this.tagItemName;let e=[];t.forEach(r=>{if(0===a.length){if(this.tagName===r.tagName){let t=Object.assign({},this.defalutSku);t.properties=s,a.push(t)}else r.tagItems.forEach(t=>{let e=Object.assign({},this.defalutSku);e.properties=`${r.tagName}:${t.propValue}`,a.push(e)});1===t.length&&(a=this.skuList.concat(a))}else e=[],this.tagName===r.tagName?a.forEach(t=>{if(-1===t.properties.indexOf(this.tagName)){let a=Object.assign({},t);a.properties=`${t.properties};${s}`,e.push(a)}}):r.tagItems.forEach(t=>{a.forEach(a=>{if(-1===a.properties.indexOf(r.tagName)){let s=Object.assign({},a);s.properties=`${a.properties};${r.tagName}:${t.propValue}`,e.push(s)}})}),a=this.skuList.concat(e),console.log("skuList",a)})}else{let e=[];t.forEach(t=>{0===a.length?t.tagItems.forEach(e=>{let s=Object.assign({},this.defalutSku);s.properties=`${t.tagName}:${e.propValue}`,a.push(s)}):(e=[],t.tagItems.forEach(s=>{a.forEach(a=>{let r=Object.assign({},a);r.properties=`${a.properties};${t.tagName}:${s.propValue}`,e.push(r)})}),a=e)})}a.length||a.push(Object.assign({},this.defalutSku)),this.$emit("change",a)},deep:!0}},methods:{init(t){if(this.value=t,!t||!t.length)return this.skuTags=[],void this.$emit("change",[Object.assign({},this.defalutSku)]);this.initing=!0;let e=[];for(let a=0;a<t.length;a++){const s=t[a];if(!s.properties)break;let r=s.properties.split(";");for(let t in r){let a=r[t].split(":");e[t]||(e[t]={tagName:a[0],tagItems:[]},this.tagItemInputs.push({visible:!1,value:""}));let s=e[t].tagItems.findIndex(t=>t.propValue===a[1]);-1===s&&e[t].tagItems.push({propValue:a[1]})}}this.skuTags=e},shopTagInput(){this.isShowTagInput=!this.isShowTagInput},hideTagInput(){this.isShowTagInput=!1,this.cleanTagInput()},addTag(){let t=this.addTagInput.selectValues;if(!this.addTagInput.propName)return void this.$message.error("请输入规格名");if(!t.length)return void this.$message.error("请输入规格值");this.isShowTagInput=!1;for(let a=0;a<t.length;a++){const e=t[a];let s="[object Object]"===Object.prototype.toString.call(e);if(!s){this.maxPropId=this.maxPropId+1;break}}let e=[];for(let a=0;a<t.length;a++){const s=t[a];let r="[object Object]"===Object.prototype.toString.call(s);r?e.push(s):(this.maxValueId=this.maxValueId+1,e.push({propId:this.maxPropId,propValue:s,valueId:this.maxValueId}))}this.$store.commit("prod/addSkuTag",{tagName:this.addTagInput.propName,tagItems:e}),this.type=1,this.cleanTagInput()},cleanTagInput(){this.addTagInput={propName:"",selectValues:[]},this.dbTagValues=[]},handleTagClick(){this.dbTagValues=[],this.addTagInput.selectValues=[];let t=this.dbTags.findIndex(t=>t.propName===this.addTagInput.propName);-1!==t&&this.$http({url:this.$http.adornUrl("/prod/spec/listSpecValue/"+this.dbTags[t].propId),method:"get",params:this.$http.adornParams()}).then(({data:t})=>{this.dbTagValues=t})},handleTagClose(t,e){this.tagName=this.skuTags[t].tagName,this.tagNameIndex=t,this.tagItemName=this.skuTags[t].tagItems[e].propValue,1!==this.skuTags[t].tagItems.length&&(this.type=4,this.$store.commit("prod/removeSkuTagItem",{tagIndex:t,tagItemIndex:e}))},handleInputConfirm(t){if(this.checkTagItem(t))return;var e=this.skuTags[t].tagItems,a=this.tagItemInputs[t].value;let s=e.length-1;this.tagName=this.skuTags[t].tagName,this.tagItemName=this.tagItemInputs[t].value;let r=this.getMaxValueId(this.skuTags[t].tagItems),i={propId:-1===s?0:this.skuTags[t].tagItems[s].propId,propValue:a,valueId:-1===s?0:r+1};i&&this.$store.commit("prod/addSkuTagItem",{tagIndex:t,tagItem:i}),this.tagItemInputs[t].visible=!1,this.tagItemInputs[t].value="",this.type=2},showTagInput(t){this.tagItemInputs.push({visible:!1,value:""}),this.tagItemInputs[t].visible=!0,this.$nextTick(()=>{this.$refs["saveTagInput"+t][0].$refs.input.focus()})},getMaxValueId(t){let e=Math.max.apply(Math,t.map(t=>t.valueId));return e},removeTag(t){this.type=3,this.$store.commit("prod/removeSkuTag",t)},checkTagItem(t){let e=this.tagItemInputs[t].value;if(!e)return this.tagItemInputs[t].visible=!1,this.tagItemInputs[t].value="",!0;var a=!1;return this.skuTags.forEach(t=>{let s=t.tagItems.map((t,e)=>t.propValue);if(s.indexOf(e)>-1)return a=!0,this.$message.error("product.specificationValue"),!1}),a}}},o=i,n=(a("432f"),a("2877")),l=Object(n["a"])(o,s,r,!1,null,null,null);e["default"]=l.exports},"8e08":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-prod-info"},[a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"產品图片"}},[a("mul-pic-upload",{model:{value:t.dataForm.imgs,callback:function(e){t.$set(t.dataForm,"imgs",e)},expression:"dataForm.imgs"}})],1),a("el-form-item",{attrs:{label:"狀態"}},[a("el-radio-group",{model:{value:t.dataForm.status,callback:function(e){t.$set(t.dataForm,"status",e)},expression:"dataForm.status"}},[a("el-radio",{attrs:{label:1}},[t._v("上架")]),a("el-radio",{attrs:{label:0}},[t._v("下架")])],1)],1),a("el-form-item",{attrs:{label:"產品分类",rules:[{required:!0,message:"请选择產品分类"}],prop:"categoryId"}},[a("el-col",{attrs:{span:8}},[a("el-cascader",{attrs:{"expand-trigger":"hover",options:t.category.list,props:t.category.props,"change-on-select":""},on:{change:t.handleCategoryChange},model:{value:t.category.selected,callback:function(e){t.$set(t.category,"selected",e)},expression:"category.selected"}})],1)],1),a("el-form-item",{attrs:{label:"產品分组",rules:[{required:!0,message:"请选择產品分组"}]}},[a("el-col",{attrs:{span:8}},[a("el-select",{staticStyle:{width:"250px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:t.dataForm.tagList,callback:function(e){t.$set(t.dataForm,"tagList",e)},expression:"dataForm.tagList"}},t._l(this.tags,(function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})})),1)],1)],1),a("el-form-item",{attrs:{label:"產品名稱",prop:"prodName",rules:[{required:!0,message:"產品名称不能为空"},{pattern:/\s\S+|S+\s|\S/,message:"請輸入正確的產品名稱",trigger:"blur"}]}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"產品名称",maxlength:"50"},model:{value:t.dataForm.prodName,callback:function(e){t.$set(t.dataForm,"prodName",e)},expression:"dataForm.prodName"}})],1)],1),a("el-form-item",{attrs:{label:"產品卖点",prop:"brief",rules:[{required:!1,pattern:/\s\S+|S+\s|\S/,message:"請輸入正確的產品賣點",trigger:"blur"}]}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"產品賣點"},model:{value:t.dataForm.brief,callback:function(e){t.$set(t.dataForm,"brief",e)},expression:"dataForm.brief"}})],1)],1),a("el-form-item",{attrs:{label:"配送方式"}},[a("el-checkbox",{model:{value:t.dataForm.deliveryMode.hasShopDelivery,callback:function(e){t.$set(t.dataForm.deliveryMode,"hasShopDelivery",e)},expression:"dataForm.deliveryMode.hasShopDelivery"}},[t._v("商家配送")]),a("el-checkbox",{model:{value:t.dataForm.deliveryMode.hasUserPickUp,callback:function(e){t.$set(t.dataForm.deliveryMode,"hasUserPickUp",e)},expression:"dataForm.deliveryMode.hasUserPickUp"}},[t._v("用戶自提")])],1),a("prod-transport",{directives:[{name:"show",rawName:"v-show",value:t.dataForm.deliveryMode.hasShopDelivery,expression:"dataForm.deliveryMode.hasShopDelivery"}],model:{value:t.dataForm.deliveryTemplateId,callback:function(e){t.$set(t.dataForm,"deliveryTemplateId",e)},expression:"dataForm.deliveryTemplateId"}}),a("sku-tag",{ref:"skuTag",attrs:{skuList:t.dataForm.skuList},on:{change:t.skuTagChangeSkuHandler}}),a("sku-table",{ref:"skuTable",attrs:{prodName:t.dataForm.prodName},on:{"update:prodName":function(e){return t.$set(t.dataForm,"prodName",e)},"update:prod-name":function(e){return t.$set(t.dataForm,"prodName",e)}},model:{value:t.dataForm.skuList,callback:function(e){t.$set(t.dataForm,"skuList",e)},expression:"dataForm.skuList"}}),a("el-form-item",{attrs:{label:"產品詳情",prop:"content"}},[a("tiny-mce",{ref:"content",staticStyle:{width:"1000px"},model:{value:t.dataForm.content,callback:function(e){t.$set(t.dataForm,"content",e)},expression:"dataForm.content"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.dataFormSubmit()}}},[t._v("確定")])],1)],1)],1)},r=[],i=a("ed08"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-upload",{attrs:{action:t.$http.adornUrl("/admin/file/upload/element"),headers:{Authorization:t.$cookie.get("Authorization")},"list-type":"picture-card","on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-success":t.handleUploadSuccess,"file-list":t.imageList,"before-upload":t.beforeAvatarUpload}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},n=[],l={data(){return{dialogImageUrl:"",dialogVisible:!1,resourcesUrl:"http://43.142.163.14:8081/images/"}},props:{value:{default:"",type:String}},computed:{imageList(){let t=[];if(this.value){let e=this.value.split(",");for(let a=0;a<e.length;a++)t.push({url:this.resourcesUrl+e[a],response:e[a]})}return this.$emit("input",this.value),t}},methods:{handleUploadSuccess(t,e,a){let s=a.map(t=>t.response).join(",");this.$emit("input",s)},beforeAvatarUpload(t){const e="image/jpeg"===t.type||"image/png"===t.type||"image/gif"===t.type||"image/jpg"===t.type;e||this.$message.error("上传图片只能是jpeg/jpg/png/gif 格式!");const a=t.size/1024/1024<2;return a||this.$message.error("上传图片大小不能超过 2MB!"),a&&e},handleRemove(t,e){let a=e.map(t=>t.response).join(",");this.$emit("input",a)},handlePictureCardPreview(t){this.dialogImageUrl=t.url,this.dialogVisible=!0}}},u=l,p=a("2877"),d=Object(p["a"])(u,o,n,!1,null,null,null),c=d.exports,m=a("692f"),h=a("8497"),g=a("9279"),f=a("0e93"),b=a("20ca"),v={data(){return{category:{list:[],selected:[],props:{value:"categoryId",label:"categoryName"}},dataForm:{prodName:"",brief:"",pic:"",imgs:"",categoryId:0,prodId:0,skuList:[],tagList:[],content:"",status:1,deliveryMode:{hasShopDelivery:!1,hasUserPickUp:!1},deliveryTemplateId:null},tags:[],resourcesUrl:"http://43.142.163.14:8081/images/"}},components:{MulPicUpload:c,ProdTransport:m["default"],TinyMce:f["a"],SkuTag:h["default"],SkuTable:g["default"]},computed:{defalutSku(){return this.$store.state.prod.defalutSku}},activated(){this.dataForm.prodId=this.$route.query.prodId,this.getDataList()},methods:{getDataList(){this.getTagList(),this.getCategoryList().then(()=>{this.dataForm.prodId?this.$http({url:this.$http.adornUrl("/prod/prod/info/"+this.dataForm.prodId),method:"get",params:this.$http.adornParams()}).then(({data:t})=>{this.dataForm=t,this.dataForm.deliveryMode=JSON.parse(t.deliveryMode),this.$refs.skuTag.init(t.skuList),this.$refs.skuTable.init(),this.category.selected=Object(i["c"])(this.category.list,this.dataForm.categoryId,"categoryId","children").reverse(),this.dataForm.tagList=t.tagList}):this.$nextTick(()=>{this.$refs["dataForm"].resetFields(),this.$refs.skuTag.init(),this.dataForm.pic="",this.dataForm.imgs=""})})},getCategoryList(){return this.$http({url:this.$http.adornUrl("/prod/category/listCategory"),method:"get",params:this.$http.adornParams()}).then(({data:t})=>{this.category.list=Object(i["e"])(t,"categoryId","parentId")})},handleCategoryChange(t){this.dataForm.categoryId=t[t.length-1]},dataFormSubmit:Object(b["a"])((function(){this.$refs["dataForm"].validate(t=>{if(!t)return;if(!this.dataForm.imgs)return void this.errorMsg("请选择图片上传");if(!this.dataForm.deliveryMode)return void this.errorMsg("请选择配送方式");if(this.dataForm.deliveryMode.hasShopDelivery&&!this.dataForm.deliveryTemplateId)return void this.errorMsg("请选择运费模板");let e=Object.assign({},this.dataForm);this.paramSetPriceAndStocks(e),e.deliveryMode=void 0,e.deliveryModeVo=this.dataForm.deliveryMode,e.pic=this.dataForm.imgs.split(",")[0],this.$http({url:this.$http.adornUrl("/prod/prod"),method:e.prodId?"put":"post",data:this.$http.adornData(e)}).then(({data:t})=>{this.$message({message:"操作成功",type:"success",duration:1500,onClose:()=>{this.visible=!1,this.$store.commit("common/removeMainActiveTab"),this.$router.push({name:"prod-prodList"}),this.$emit("refreshDataList")}})})})})),paramSetPriceAndStocks(t){t.totalStocks=0,t.price=0,t.oriPrice=0;for(let e=0;e<t.skuList.length;e++){const a=t.skuList[e];1===a.status&&(0===t.price&&(t.price=a.price?Number.parseFloat(a.price):0),t.price=Math.min(t.price,a.price),t.price===a.price&&(t.oriPrice=a.oriPrice?Number.parseFloat(a.oriPrice):0),t.totalStocks+=a.stocks?Number.parseInt(a.stocks):0)}1===t.skuList.length&&(t.skuList[0].prodName=this.dataForm.prodName)},skuTagChangeSkuHandler(t){const e=this.dataForm.prodName;t.forEach(t=>{if(t.properties){t.skuName="";let a=t.properties.split(";");for(const e in a)t.skuName+=a[e].split(":")[1]+" ";t.prodName=e+" "+t.skuName}}),this.dataForm.skuList=t},errorMsg(t){this.$message({message:t,type:"error",duration:1500})},getTagList(){this.$http({url:this.$http.adornUrl("/prod/prodTag/listTagList"),method:"get",params:this.$http.adornParams()}).then(({data:t})=>{this.tags=t})}}},y=v,k=Object(p["a"])(y,s,r,!1,null,null,null);e["default"]=k.exports},9279:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-prod-sku-table"},[a("el-form-item",[a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.value,border:"","span-method":t.tableSpanMethod}},[t._l(t.tableLeftTitles,(function(e,s){return a("el-table-column",{key:s,attrs:{label:e},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.properties.split(";")[s].split(":")[1])+" ")]}}],null,!0)})})),t.tableLeftTitles.length?a("el-table-column",{attrs:{prop:"pic",label:"sku圖片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("pic-upload",{model:{value:e.row.pic,callback:function(a){t.$set(e.row,"pic",a)},expression:"scope.row.pic"}})]}}],null,!1,1005777877)}):t._e(),t.tableLeftTitles.length?a("el-table-column",{attrs:{prop:"prodName",label:"商品名稱",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{type:"textarea",disabled:!e.row.status},model:{value:e.row.prodName,callback:function(a){t.$set(e.row,"prodName",a)},expression:"scope.row.prodName"}})]}}],null,!1,1047629452)}):t._e(),a("el-table-column",{attrs:{prop:"price",label:"銷售價"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{size:"small","controls-position":"right",precision:2,max:1e9,min:.01,disabled:!e.row.status},model:{value:e.row.price,callback:function(a){t.$set(e.row,"price",a)},expression:"scope.row.price"}})]}}])}),a("el-table-column",{attrs:{prop:"oriPrice",label:"市場價"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{size:"small","controls-position":"right",precision:2,max:1e9,min:.01,disabled:!e.row.status},model:{value:e.row.oriPrice,callback:function(a){t.$set(e.row,"oriPrice",a)},expression:"scope.row.oriPrice"}})]}}])}),a("el-table-column",{attrs:{prop:"stocks",label:"庫存"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{type:"number",disabled:!e.row.status},model:{value:e.row.stocks,callback:function(a){t.$set(e.row,"stocks",a)},expression:"scope.row.stocks"}})]}}])}),a("el-table-column",{attrs:{prop:"weight",label:"商品重量(kg)"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:!e.row.status},model:{value:e.row.weight,callback:function(a){t.$set(e.row,"weight",a)},expression:"scope.row.weight"}})]}}])}),a("el-table-column",{attrs:{prop:"volume",label:"商品體積(m³)"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:!e.row.status},model:{value:e.row.volume,callback:function(a){t.$set(e.row,"volume",a)},expression:"scope.row.volume"}})]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.status?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.changeSkuStatus(""+e.$index)}}},[t._v("禁用")]):a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.changeSkuStatus(""+e.$index)}}},[t._v("启用")])]}}])})],2)],1)],1)},r=[],i=a("cf95"),o={data(){return{dbSpecs:[],dbSpecValues:[],specs:[],initing:!1}},components:{PicUpload:i["a"]},props:{value:{default:[],type:Array},prodName:{default:""}},watch:{prodName:function(){this.skuAddProdName()}},created:function(){this.$http({url:this.$http.adornUrl("/prod/spec/list"),method:"get",params:this.$http.adornParams()}).then(({data:t})=>{this.dbSpecs=t})},computed:{tableLeftTitles(){let t=[];for(let e=0;e<this.skuTags.length;e++){const a=this.skuTags[e];t.push(a.tagName)}return t},skuTags:{get(){return this.$store.state.prod.skuTags}},defalutSku(){return this.$store.state.prod.defalutSku}},methods:{init(){this.initing=!0},getTableSpecData(){return this.value},tableSpanMethod({row:t,column:e,rowIndex:a,columnIndex:s}){},changeSkuStatus(t){this.value[t].status=this.value[t].status?0:1},skuAddProdName(){if(this.initing)return;let t=[];for(let e=0;e<this.value.length;e++){const a=Object.assign({},this.value[e]);if(!a.properties)return;a.skuName="";let s=a.properties.split(";");for(const t in s)a.skuName+=s[t].split(":")[1]+" ";a.prodName=this.prodName+" "+a.skuName,t.push(a)}this.$emit("input",t)}}},n=o,l=(a("1e58"),a("2877")),u=Object(l["a"])(n,s,r,!1,null,null,null);e["default"]=u.exports},aea0:function(t,e,a){},cf95:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-upload",{staticClass:"pic-uploader-component",attrs:{action:t.$http.adornUrl("/admin/file/upload/element"),headers:{Authorization:t.$cookie.get("Authorization")},"show-file-list":!1,"on-success":t.handleUploadSuccess,"before-upload":t.beforeAvatarUpload}},[t.value?a("img",{staticClass:"pic",attrs:{src:t.resourcesUrl+t.value}}):a("i",{staticClass:"el-icon-plus pic-uploader-icon"})])],1)},r=[],i={data(){return{resourcesUrl:"http://43.142.163.14:8081/images/"}},props:{value:{default:"",type:String}},methods:{handleUploadSuccess(t,e,a){this.$emit("input",e.response)},beforeAvatarUpload(t){const e=t.size/1024/1024<2,a="image/jpeg"===t.type||"image/png"===t.type||"image/gif"===t.type||"image/jpg"===t.type;return a||this.$message.error("上传图片只能是jpeg/jpg/png/gif 格式!"),e||this.$message.error("上传图片大小不能超过 2MB!"),e&&a}}},o=i,n=(a("7772"),a("2877")),l=Object(n["a"])(o,s,r,!1,null,null,null);e["a"]=l.exports}}]);